name: æ¸…é™¤ GitHub Pages è‡ªå®šä¹‰åŸŸå

on:
  workflow_dispatch:

jobs:
  clear-domain:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout gh-pages åˆ†æ”¯
        uses: actions/checkout@v3
        with:
          ref: gh-pages
          token: ${{ secrets.GITHUB_TOKEN }}

      - name: ç¡®ä¿ CNAME æ–‡ä»¶ä¸å­˜åœ¨
        run: |
          if [ -f CNAME ]; then
            echo "åˆ é™¤ CNAME æ–‡ä»¶"
            rm CNAME
            git config user.name "github-actions[bot]"
            git config user.email "github-actions[bot]@users.noreply.github.com"
            git add CNAME
            git commit -m "chore: ç§»é™¤ CNAME æ–‡ä»¶ä»¥æ¸…é™¤è‡ªå®šä¹‰åŸŸå"
            git push
          else
            echo "CNAME æ–‡ä»¶å·²ä¸å­˜åœ¨"
          fi

      - name: æç¤ºä¿¡æ¯
        run: |
          echo "âœ… å·²ç¡®ä¿ gh-pages åˆ†æ”¯æ²¡æœ‰ CNAME æ–‡ä»¶"
          echo "âš ï¸  è¯·æ³¨æ„ï¼šä½ ä»éœ€è¦æ‰‹åŠ¨åœ¨ GitHub ä»“åº“è®¾ç½®ä¸­æ¸…é™¤è‡ªå®šä¹‰åŸŸå"
          echo "ğŸ”— è®¿é—®: https://github.com/wuxiansen/wuxiansen.github.io/settings/pages"
          echo "ğŸ“ åœ¨ 'Custom domain' éƒ¨åˆ†æ¸…ç©ºåŸŸåå¹¶ä¿å­˜"
